# Conventions

## Command Line

## Version Control

### Git

- Suggest git commands when prompted to look at git history.
- Run any git command as `git --no-pager <command>`.

### GitHub CLI

- Assume the CLI `gh` when talking about anything related to GitHub (pull
requests, forks, workflows, etc.)
- Always use single-line `gh` commands.
- By default, don't specify the argument for branch, PR, Issue, etc.

### Pull Requests

#### General

- If necessary, use `gh` to find out the base branch of this PR.

#### Create

We want to merge the current branch into the base branch.

Create following these steps, suggesting them one at a time:

1. Get branch and remotes info by running these commands:
  ```
  git --no-pager branch --show-current
  git rev-parse --abbrev-ref --symbolic-full-name @{u}
  git --no-pager remote --verbose
  git --no-pager show <base-branch>..
  ```
2. Create PR with options:
  - Assign to me.
  - Generate title and body.
  
### Markdown

Use GH Markdown format for the body of PR, comments, messages, etc. Use:
- monospace for code
- latex for math
- math or code blocks if necessary

Steps (only one per message):
1. Show the Markdown text and ask for approval on its content.
2. If granted, then suggest the full command in another message.

The markdown content must be passed to command line options (e.g. `--body`, `--message`, etc.) as a
string generated by the inline command `"$(echo -e 'markdown text...')"`,
following these patterns:
  - line break: `line 1\nline 2`
  - escape backslashes
  - single quotes: `'"'"'quoted text'"'"'`

## Coding Style

### General

- Use type hints everywhere possible.
- Use `pathlib` for system paths.

### Docstrings

- Use Markdown syntax (headers, monospace, latex, etc.) in the description.

### Functions

- When creatin a new function, include descriptive docstrings, with sphinx
  style for the parameters (don't specify types).
- Update the docstring when modifying a function.
- Never hardcode constant values that can be derived from other values. Assign
  it to a variable instead.
- Place definition of constants at the beginning of the function.
- If possible, don't nest parentheses; use intermediate variables instead.

### Tests

- `mock`: Mock objects and patch functions and classes as much as possible.
- Use `pytest`-based tests: fixtures, parametrized tests, etc.
